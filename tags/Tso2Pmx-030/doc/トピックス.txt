【Tso2Pmx変換トピックス】


☆ 男MODの変換方法 ☆
TAHファイルを展開してみるとわかるのですが、
男MODは"00000000_2220525470.tso"なる名前のTSOファイルのみで構成されています。
これをヘビセと同様にTso2Pmxにドラッグ&ドロップしてください。
ヘビセと同様に変換されます。ただし、体型変更などは適用されません。



☆ 背景の変換方法 ☆
背景のTAHファイルを展開すると、２つのTSOファイルが含まれています。
この２つのTSOファイルを、

① Tso2MqoGuiを使って、マージ（結合）する
② Tso2PmxにマージしたTSOファイルをドラッグ&ドロップする
③ Tso2Pmxの"出力されるボーン構造"について、"1ボーン"を選択する
④ 変換ボタンを押す

とすることにより、カスタム少女の背景をPMXファイルにすることができます。



☆ 体型の追加方法 ☆
体型変更はTMOProportionと同じ仕様になっています。
TPOEditorで新たに作成した.csファイルを、
実行ファイルと同一フォルダにある"Proportion"という名前のフォルダに追加すると、
Tso2PmxのコンボBOXの中に体型が追加され、選択できるようになります。



☆ 初期ポーズの変更 ☆
Tso2Pmxでは、モーションがそのまま適応できるように、
初期ポーズをMMDのデフォルトモデルに近いものに調整しています。
このポーズ設定は、Proportionフォルダ内のAAA_PMDInitPose.csで指定しており、
これを変更することで、初期ポーズを変更することが可能です。



☆ 表情の追加・変更の方法 ☆
次の2ステップだけで、表情が追加されます。

① POSEデータ(.tdcgpose.png)より、TMOファイル(.tmo)を抽出
② 実行ファイルと同一フォルダにある"表情"という名前フォルダの中の、
"目"、"リップ"、"まゆ"、"その他"のいづれかのフォルダに抽出したTMOファイルを追加

ただし、ファイル名がそのまま表情名になります。

尚、体や髪などはどのようなポーズをとっていても構いません。
表情に関係するボーン変形のみをTso2Pmx側で抽出する仕様になっています。
"目"フォルダなら、目のボーンのみ、
"リップ"フォルダなら、リップのボーンのみ、
"まゆ"フォルダなら、まゆのボーンのみ、
"その他"フォルダなら、目、リップ、まゆのボーンのみ、が抽出されます。



☆ 輪郭線について ☆
『影＆輪郭線の表示』を有効にすると、ある一帯が黒で塗りつぶされたようになります。
塗りつぶしが起こる原因は、２つあるようです。

(a) エッジが密集しすぎている
(b) カスタム少女の輪郭用ポリゴンとの重複

対策は、２つあります。

(a) 輪郭用ポリゴンを変換前に非選択にする
(b) PMDエディタで、塗りつぶされる部位に対応する材質のedge_flagを0にする



☆ Toonテクスチャ数の上限について ☆
MMDの仕様より、Toonテクスチャ数の上限は10個と決まっています。
Tso2Pmxでは、以下のような方針をとっています。

・存在するToonテクスチャは、全てビットマップファイルとして出力
・PMDファイルに登録するのは、9番目のToonテクスチャまで
・それ以降は、全て10番目のToonテクスチャとして登録
・10番目のToonテクスチャには、ダミーのToonテクスチャを登録

変換後に、PMDエディタで個別に調整ください。

        nomeu追記：
        PMXではToonテクスチャ数に上限はありません。


☆ スフィアマップを利用した、色とびの補正について ☆
Toonテクスチャに、陰影以外の、肌のベース色などが描かれている場合、
セルフシャドウ使用時では、これが反映されず、色がとんでしまうという現象があります。
これはMMDの仕様によるものです。

Tso2Pmxでは、これを克服するために、
スフィアマップを利用して、セルフシャドウ時での色とびを補正しています。
具体的には、

① Toonテクスチャの左上の1ピクセルの色で1x1のbmpファイルを作成
② 拡張子を.sphに変更
③ スフィアマップにこのファイルを指定

ということをしています。

この機能は、
"□ スフィアマップを利用して、Toonテクスチャの色とびを補正する"
のチェックを外せば無効になります。
また、特定の材質でのみ無効にしたい場合は、
PMDエディタを使用して、対象の材質のスフィアマップの項目を空白に変更してください。



☆ セルフシャドウによる顔に落ちる影が怖い ☆
次のような対策が考えられます。

(a) セルフシャドウをOFFにする
(b) 特定の材質について、陰の色を変更する
(c) 特定の材質について、陰が反映しないようにする

(a)(b)(c)のいづれにしても、MMD作者自身の解説動画が参考になるでしょう。

http://www.nicovideo.jp/watch/sm9395644

端的にいうなら、
(b)のためには、Toonテキスチャの左下1ピクセルの色を変更し、
(c)のためには、材質のα値を0.98にすればよい、
とのことです。

* Tso2Pmxで変換されたモデルは、左下1ピクセルでなく、
左下7ピクセル目となっているようです。原因は調査中です。

☆ 材質の描画順番は、3Dカスタム少女とMMDでは逆になります。
なので、透明な材質が不適切な順序で描かれることがあります。
この場合はPMDEditorで材質の描画順番を入れ替えてください。
またαチャネルで形状を表現している材質の輪郭線を有効にすると、
αチャンネルが０の裏面の輪郭線がMMD上で表示されることが
あります。この場合には材質の輪郭線を消してください。
